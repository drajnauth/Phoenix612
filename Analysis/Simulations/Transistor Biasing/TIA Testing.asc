Version 4
SHEET 1 2140 1880
WIRE -416 -32 -464 -32
WIRE -256 -32 -336 -32
WIRE -160 -32 -256 -32
WIRE 160 -32 -160 -32
WIRE 464 -32 160 -32
WIRE 720 -32 464 -32
WIRE -464 0 -464 -32
WIRE -256 0 -256 -32
WIRE 464 32 464 -32
WIRE 160 48 160 -32
WIRE 720 48 720 -32
WIRE -256 96 -256 64
WIRE -464 112 -464 80
WIRE -160 160 -160 -32
WIRE -16 176 -48 176
WIRE 160 176 160 128
WIRE 160 176 128 176
WIRE 208 176 160 176
WIRE 320 176 288 176
WIRE 160 192 160 176
WIRE 464 192 464 112
WIRE 160 224 160 192
WIRE 464 224 464 192
WIRE -272 272 -368 272
WIRE -160 272 -160 240
WIRE -160 272 -208 272
WIRE -48 272 -48 176
WIRE -48 272 -160 272
WIRE 64 272 -48 272
WIRE 96 272 64 272
WIRE 320 272 320 176
WIRE 384 272 320 272
WIRE 400 272 384 272
WIRE 720 272 720 128
WIRE -368 304 -368 272
WIRE -160 304 -160 272
WIRE 720 320 720 272
WIRE 160 336 160 320
WIRE 176 336 160 336
WIRE 256 336 240 336
WIRE 160 352 160 336
WIRE 256 352 256 336
WIRE -368 368 -368 304
WIRE 160 368 160 352
WIRE 464 368 464 320
WIRE 480 368 464 368
WIRE 512 368 480 368
WIRE 640 368 592 368
WIRE 656 368 640 368
WIRE 464 384 464 368
WIRE -160 416 -160 384
WIRE -368 464 -368 448
WIRE 160 464 160 448
WIRE 256 464 256 432
WIRE 256 464 160 464
WIRE 720 464 720 416
WIRE 752 464 720 464
WIRE 944 464 896 464
WIRE 160 480 160 464
WIRE 464 480 464 464
WIRE 720 496 720 464
WIRE 944 496 944 464
WIRE 720 512 720 496
WIRE 720 608 720 592
WIRE 944 608 944 576
FLAG 464 480 0
FLAG -464 112 0
FLAG -368 464 0
FLAG -368 304 Vin
FLAG 384 272 Vb2
FLAG 464 192 Vc2
FLAG 480 368 Ve2
FLAG -256 96 0
FLAG 160 480 0
FLAG 720 608 0
FLAG 720 496 Ve3
FLAG 944 608 0
FLAG -160 416 0
FLAG 640 368 Vb3
FLAG 720 272 Vc3
FLAG 64 272 Vb1
FLAG 160 192 Vc1
FLAG 160 352 Ve1
FLAG 944 464 Vout
SYMBOL npn 96 224 R0
WINDOW 3 56 58 Left 2
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL voltage -464 -16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vcc
SYMATTR Value 12
SYMBOL res 448 368 R0
SYMATTR InstName R3
SYMATTR Value 2.2K
SYMBOL cap -272 0 R0
SYMATTR InstName C5
SYMATTR Value .1µ
SYMBOL npn 400 224 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL npn 656 320 R0
WINDOW 0 56 18 Left 2
WINDOW 3 56 50 Left 2
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res -176 144 R0
SYMATTR InstName R1
SYMATTR Value 10K
SYMBOL res -176 288 R0
SYMATTR InstName R2
SYMATTR Value 2.2K
SYMBOL res 144 32 R0
SYMATTR InstName R4
SYMATTR Value 470
SYMBOL res 144 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1.5K
SYMBOL cap 48 160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value .1µ
SYMBOL cap -208 256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value .1µ
SYMBOL cap 896 448 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value .1µ
SYMBOL res 704 496 R0
SYMATTR InstName R6
SYMATTR Value 470
SYMBOL res 928 480 R0
SYMATTR InstName Rload
SYMATTR Value 50R
SYMBOL res 144 352 R0
SYMATTR InstName R8
SYMATTR Value 180
SYMBOL cap 240 320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C12
SYMATTR Value .1µ
SYMBOL res 240 336 R0
SYMATTR InstName R9
SYMATTR Value 10
SYMBOL res -320 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10R
SYMBOL res 304 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcouple1
SYMATTR Value .001
SYMBOL res 608 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcouple2
SYMATTR Value .001
SYMBOL res 848 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcouple3
SYMATTR Value .001
SYMBOL voltage -368 352 R0
WINDOW 0 -45 11 Left 2
WINDOW 3 -214 95 Left 2
WINDOW 123 -214 123 Left 2
WINDOW 39 -214 151 Left 2
SYMATTR InstName Vi
SYMATTR Value SINE(0 {S} {F})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser={Z}
SYMBOL res 480 128 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rsense1
SYMATTR Value .001
SYMBOL res 736 144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rsense2
SYMATTR Value .001
TEXT 1032 -680 Left 2 !.options plotwinsize=0\n.options numdgt = 8\n \n \n \n.meas TRAN Vinr RMS V(Vin)\n.meas TRAN Voutr RMS V(Vout)\n.meas TRAN Ioutr RMS I(Rload)\n.meas TRAN Iinr RMS I(Vi)\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Vb1r RMS V(Vb1)\n.meas TRAN Vc1r RMS V(Vc1)\n.meas TRAN Ve1r RMS V(Ve1)\n.meas TRAN Ic1r RMS Ic(Q1)\n.meas TRAN Ib1r RMS Ib(Q1)\n.meas TRAN Vb1avg AVG V(Vb1)\n.meas TRAN Vb1max MAX V(Vb1)\n.meas TRAN Vb1min MIN V(Vb1)\n.meas TRAN Vpp1r PARAM Vb1max-Vb1min\n.meas TRAN Vp1r PARAM Vb1max-Vbe\n.meas TRAN Cd1 PARAM Vp1r/Vpp1r\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n \n.meas TRAN Vb2r RMS V(Vb2)\n.meas TRAN Vc2r RMS V(Vc2)\n.meas TRAN Ve2r RMS V(Ve2)\n.meas TRAN Ic2r RMS Ic(Q2)\n.meas TRAN Ib2r RMS Ib(Q2)\n.meas TRAN Vb2avg AVG V(Vb2)\n.meas TRAN Vb2max MAX V(Vb2)\n.meas TRAN Vb2min MIN V(Vb2)\n.meas TRAN Vpp2r PARAM Vb2max-Vb2min\n.meas TRAN Vp2r PARAM Vb2max-Vbe\n.meas TRAN Cd2 PARAM Vp2r/Vpp2r\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n \n.meas TRAN Vb3r RMS V(Vb3)\n.meas TRAN Vc3r RMS V(Vc3)\n.meas TRAN Ve3r RMS V(Ve3)\n.meas TRAN Ic3r RMS Ic(Q3)\n.meas TRAN Ib3r RMS Ib(Q3)\n.meas TRAN Vb3avg AVG V(Vb3)\n.meas TRAN Vb3max MAX V(Vb3)\n.meas TRAN Vb3min MIN V(Vb3)\n.meas TRAN Vpp3r PARAM Vb3max-Vb3min\n.meas TRAN Vp3r PARAM Vb3max-Vbe\n.meas TRAN Cd3 PARAM Vp3r/Vpp3r\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Icouple1 RMS I(Rcouple1)\n.meas TRAN Icouple2 RMS I(Rcouple2)\n.meas TRAN Icouple3 RMS I(Rcouple3)\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN PQ1dis AVG (V(Vc1,Ve1)*Ic(Q1) + V(Vb1,Ve1)*Ib(Q1))\n.meas TRAN PQ2dis AVG (V(Vc2,Ve2)*Ic(Q2) + V(Vb2,Ve2)*Ib(Q2))\n.meas TRAN PQ3dis AVG (V(Vc3,Ve3)*Ic(Q3) + V(Vb3,Ve3)*Ib(Q3))\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Zin PARAM Vinr/Iinr\n.meas TRAN Zout PARAM Voutr/Ioutr \n.meas TRAN ZQ1in PARAM Vb1r/Ib1r \n.meas TRAN ZQ1out PARAM Vc1r/Icouple1\n.meas TRAN ZQ2in PARAM Vb2r/Ib2r \n.meas TRAN ZQ2out PARAM Ve2r/Icouple2\n.meas TRAN ZQ3in PARAM Vb3r/Ib3r \n.meas TRAN Zq3out PARAM Ve3r/Icouple3 \n ;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Q1Angle PARAM Cd1*360\n.meas TRAN Q2Angle PARAM Cd2*360\n.meas TRAN Q3Angle PARAM Cd3*360\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Pin PARAM Zin*Iinr*Iinr\n.meas TRAN Pout AVG (V(Vout)*I(Rload))\n.meas TRAN Pmar1 PARAM Pout-PQ1dis\n.meas TRAN Pmar2 PARAM Pout-PQ2dis\n.meas TRAN Pmar3 PARAM Pout-PQ3dis\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Gp PARAM 10*log10(Pout/Pin)\n.meas TRAN Gv PARAM 20*log10(Voutr/Vinr)\n \n.four {F} 4 -1 V(Vout)
TEXT -656 284 Left 2 !.tran 0 10u
TEXT -688 -168 Left 2 !;.step param F list 1.5Meg 3.7Meg 5.37Meg 7.1Meg 10.1Meg 14.1Meg 21.1Meg 28.7Meg\n.step param F list 3.7Meg 14.1Meg 28.7Meg\n;.param F 30Meg\n.param S .1\n.param Z 2\n.param Vbe 0.68
