Version 4
SHEET 1 4348 1640
WIRE 0 -176 -240 -176
WIRE 64 -176 0 -176
WIRE 256 -176 64 -176
WIRE 512 -176 256 -176
WIRE 608 -176 512 -176
WIRE 736 -176 608 -176
WIRE 1040 -176 736 -176
WIRE 1136 -176 1040 -176
WIRE 0 -160 0 -176
WIRE 512 -160 512 -176
WIRE 736 -160 736 -176
WIRE 1040 -160 1040 -176
WIRE 256 -144 256 -176
WIRE 0 -80 0 -96
WIRE 512 -80 512 -96
WIRE 736 -80 736 -96
WIRE 1040 -80 1040 -96
WIRE 256 -48 256 -64
WIRE 1136 -32 1136 -176
WIRE 608 80 608 -176
WIRE 912 112 880 112
WIRE 1024 112 992 112
WIRE 1136 112 1136 48
WIRE 1136 112 1088 112
WIRE 1264 112 1136 112
WIRE 1552 112 1328 112
WIRE 1616 112 1552 112
WIRE 1136 144 1136 112
WIRE 1136 160 1136 144
WIRE 1552 160 1552 112
WIRE 64 208 64 -176
WIRE 432 240 336 240
WIRE 528 240 512 240
WIRE 608 240 608 160
WIRE 608 240 592 240
WIRE 640 240 608 240
WIRE 816 240 816 176
WIRE 816 240 784 240
WIRE 880 240 880 112
WIRE 880 240 816 240
WIRE 896 240 880 240
WIRE 992 240 960 240
WIRE 1056 240 992 240
WIRE 1088 240 1056 240
WIRE -240 256 -240 -176
WIRE 608 272 608 240
WIRE 992 272 992 240
WIRE 1552 272 1552 240
WIRE 608 288 608 272
WIRE 1136 288 1136 256
WIRE 64 368 64 288
WIRE 96 368 64 368
WIRE 192 368 160 368
WIRE 304 368 304 320
WIRE 304 368 272 368
WIRE 336 368 336 240
WIRE 336 368 304 368
WIRE 528 368 400 368
WIRE 560 368 528 368
WIRE 64 400 64 368
WIRE 400 400 400 368
WIRE 608 416 608 384
WIRE -512 448 -560 448
WIRE -368 448 -432 448
WIRE -336 448 -368 448
WIRE -240 448 -240 336
WIRE -240 448 -272 448
WIRE -64 448 -240 448
WIRE 0 448 -64 448
WIRE -560 464 -560 448
WIRE -240 496 -240 448
WIRE 816 496 736 496
WIRE 848 496 816 496
WIRE 992 496 992 352
WIRE 992 496 928 496
WIRE 992 528 992 496
WIRE 64 544 64 496
WIRE 96 544 64 544
WIRE 176 544 160 544
WIRE 816 544 816 496
WIRE -560 560 -560 544
WIRE 176 560 176 544
WIRE 64 576 64 544
WIRE -240 592 -240 576
WIRE 992 608 992 592
WIRE 400 624 400 480
WIRE 464 624 400 624
WIRE 576 624 544 624
WIRE 640 624 576 624
WIRE 688 624 640 624
WIRE 736 624 736 496
WIRE 736 624 688 624
WIRE 816 624 816 608
WIRE 400 656 400 624
WIRE 688 656 688 624
WIRE 576 672 576 624
WIRE 64 688 64 656
WIRE 176 688 176 640
WIRE 176 688 64 688
WIRE 64 736 64 688
WIRE 400 736 400 720
WIRE 576 752 576 736
WIRE 688 752 688 736
FLAG 256 -48 0
FLAG 1552 272 0
FLAG 1616 112 Vout
FLAG -560 560 0
FLAG -368 448 Vin
FLAG 608 416 0
FLAG 528 368 Vg1
FLAG 608 272 Vd1
FLAG 576 752 0
FLAG 400 736 0
FLAG 688 752 0
FLAG 640 624 Vbias2
FLAG -384 496 0
FLAG 512 -80 0
FLAG 1136 288 0
FLAG 1056 240 Vg2
FLAG 1136 144 Vd2
FLAG 816 624 0
FLAG 992 608 0
FLAG 1040 -80 0
FLAG 736 -80 0
FLAG 816 176 Vs2
FLAG -240 592 0
FLAG 64 736 0
FLAG -64 448 Vb
FLAG 64 544 Ve
FLAG 64 368 Vc
FLAG 0 -80 0
FLAG 304 320 Vs1
SYMBOL voltage 256 -160 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL res 1536 144 R0
SYMATTR InstName Rout
SYMATTR Value 100
SYMBOL voltage -560 448 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V5
SYMATTR Value SINE(0 {S} {F})
SYMBOL nmos 560 288 R0
WINDOW 3 56 60 Left 2
SYMATTR Value BS170
SYMATTR InstName M1
SYMATTR Prefix X
SYMBOL res 384 384 R0
SYMATTR InstName R3
SYMATTR Value 4K
SYMBOL cap 1264 128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C4
SYMATTR Value .1µ
SYMBOL ind2 448 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName RFC2
SYMATTR Value 10µ
SYMATTR Type ind
SYMBOL cap 560 672 R0
SYMATTR InstName C10
SYMATTR Value .1µ
SYMBOL cap 384 656 R0
SYMATTR InstName C11
SYMATTR Value .1µ
SYMBOL voltage 688 640 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value {BM2}
SYMBOL cap 96 384 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C14
SYMATTR Value .1µ
SYMBOL cap 496 -160 R0
SYMATTR InstName C1
SYMATTR Value .1µ
SYMBOL nmos 1088 160 R0
WINDOW 3 56 60 Left 2
SYMATTR Value BS170
SYMATTR InstName M2
SYMATTR Prefix X
SYMBOL res 976 256 R0
SYMATTR InstName R1
SYMATTR Value 4K
SYMBOL ind2 832 512 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName RFC1
SYMATTR Value 10µ
SYMATTR Type ind
SYMBOL cap 800 544 R0
SYMATTR InstName C2
SYMATTR Value .1µ
SYMBOL cap 976 528 R0
SYMATTR InstName C3
SYMATTR Value .1µ
SYMBOL ind2 1120 -48 R0
SYMATTR InstName RFC3
SYMATTR Value 66µ
SYMATTR Type ind
SYMBOL cap 896 256 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value .1µ
SYMBOL cap 1024 -160 R0
SYMATTR InstName C6
SYMATTR Value .1µ
SYMBOL cap 720 -160 R0
SYMATTR InstName C7
SYMATTR Value 100µ
SYMBOL cap 640 256 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value .1µ
SYMBOL res 800 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rsense2
SYMATTR Value .0001
SYMBOL res -416 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin
SYMATTR Value {Z}
SYMBOL cap 1088 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value .1µ
SYMBOL res 1008 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 800
SYMBOL res -256 240 R0
SYMATTR InstName R2
SYMATTR Value 5813
SYMBOL res -256 480 R0
SYMATTR InstName R5
SYMATTR Value 1215
SYMBOL res 48 560 R0
SYMATTR InstName R6
SYMATTR Value 35
SYMBOL cap 160 528 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C16
SYMATTR Value .1µ
SYMBOL npn 0 400 R0
SYMATTR InstName Q1
SYMATTR Value 2N2219A
SYMBOL res 160 544 R0
SYMATTR InstName R7
SYMATTR Value 3
SYMBOL ind2 48 192 R0
SYMATTR InstName RFC5
SYMATTR Value 66µ
SYMATTR Type ind
SYMBOL ind2 592 64 R0
SYMATTR InstName RFC4
SYMATTR Value 66µ
SYMATTR Type ind
SYMBOL cap -16 -160 R0
SYMATTR InstName C12
SYMATTR Value .1µ
SYMBOL cap -336 464 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C13
SYMATTR Value .1µ
SYMBOL cap 336 384 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C15
SYMATTR Value .1µ
SYMBOL res 288 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rsense1
SYMATTR Value .0001
SYMBOL cap 592 224 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C17
SYMATTR Value .1µ
SYMBOL res 528 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 800
TEXT 2128 -560 Left 2 !.options plotwinsize=0\n.options numdgt = 8\n \n.meas TRAN Vinr RMS V(Vin)\n.meas TRAN Voutr RMS V(Vout)\n.meas TRAN Iinr RMS I(Rin)\n.meas TRAN Ioutr RMS I(Rout)\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Vgr1 RMS V(Vg1)\n.meas TRAN Vdr1 RMS V(Vd1)\n.meas TRAN Idr1 RMS Ix(M1:D)\n.meas TRAN Igr1 RMS Ix(M1:G)\n.meas TRAN Vgavg1 AVG V(Vg1)\n.meas TRAN Vgmax1 MAX V(Vg1)\n.meas TRAN Vgmin1 MIN V(Vg1)\n.meas TRAN Vbiasr1 RMS V(Vbias2)\n.meas TRAN Vppr1 PARAM Vgmax1-Vgmin1\n.meas TRAN Vpr1 PARAM Vgmax1-Vgs2\n.meas TRAN Cd1 PARAM Vpr1/Vppr1\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Vgr2 RMS V(Vg2)\n.meas TRAN Vdr2 RMS V(Vd2)\n.meas TRAN Idr2 RMS Ix(M2:D)\n.meas TRAN Igr2 RMS Ix(M2:G)\n.meas TRAN Vgavg2 AVG V(Vg2)\n.meas TRAN Vgmax2 MAX V(Vg2)\n.meas TRAN Vgmin2 MIN V(Vg2)\n.meas TRAN Vbiasr2 RMS V(Vbias2)\n.meas TRAN Vppr2 PARAM Vgmax2-Vgmin2\n.meas TRAN Vpr2 PARAM Vgmax2-Vgs2\n.meas TRAN Cd2 PARAM Vpr2/Vppr2\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Vbr RMS V(Vb)\n.meas TRAN Vcr RMS V(Vc)\n.meas TRAN Ver RMS V(Ve)\n.meas TRAN Ibr RMS Ib(Q1)\n.meas TRAN Icr RMS Ic(Q1)\n.meas TRAN Ier RMS Ie(Q1)\n.meas TRAN Vbavg AVG V(Vb)\n.meas TRAN Vbmax MAX V(Vb)\n.meas TRAN Vbmin MIN V(Vb)\n.meas TRAN Vppr PARAM Vbmax-Vbmin\n.meas TRAN Vpr PARAM Vbmax-Vbe\n.meas TRAN CdQ1 PARAM Vpr/Vppr\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Pdis1 AVG (V(vd1)*Ix(M1:D) + V(vg1)*Ix(M1:G))\n.meas TRAN Pdis2 AVG (V(vd2)*Ix(M2:D) + V(vg2)*Ix(M2:G))\n.meas TRAN Pdis3 AVG (V(Vc,Ve)*Ic(Q1) + V(Vb,Ve)*Ib(Q1))\n;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN Isr2 RMS I(Rsense2)\n.meas TRAN Vsr2 RMS V(Vs2)\n.meas TRAN Isr1 RMS I(Rsense1)\n.meas TRAN Vsr1 RMS V(Vs1)\n.meas TRAN Zin PARAM Vinr/Iinr\n.meas TRAN Zout PARAM Vdr2/Idr2\n.meas TRAN ZinM1 PARAM Vsr1/Isr1\n.meas TRAN ZinM2 PARAM Vsr2/Isr2\n.meas TRAN ZoutQ1 PARAM Vcr/Icr\n.meas TRAN ZoutM1 PARAM Vdr1/Idr1\n.meas TRAN ZoutM2 PARAM Vdr2/Idr2\n.meas TRAN CdAngleQ1 PARAM CdQ1*360\n.meas TRAN CdAngleM1 PARAM Cd1*360\n.meas TRAN CdAngleM2 PARAM Cd2*360\n.meas TRAN Pin RMS (V(Vin)*I(Rin))\n.meas TRAN Pout AVG (V(Vout)*I(Rout))\n.meas TRAN Pdis PARAM Pdis2+Pdis1+Pdis3\n.meas TRAN Pmar PARAM Pout-Pdis\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;\n.meas TRAN GQ1 PARAM (Vsr1/Vinr)\n.meas TRAN GM1 PARAM (Vsr2/Vsr1)\n.meas TRAN GM2 PARAM (Voutr/Vsr2)\n.meas TRAN Gpr PARAM (Pout/Pin)\n.meas TRAN Gvr PARAM (Voutr/Vinr)\n.meas TRAN Gp PARAM 10*log10(Gpr)\n.meas TRAN Gv PARAM 20*log10(Gvr)\n.meas TRAN Gi PARAM 20*log10(Ioutr/Iinr)\n \n.four {F} 4 -1 V(Vout)
TEXT 696 936 Left 2 !;.step param F list 1.5Meg 3.7Meg 5.37Meg 7.1Meg 10.1Meg 14.1Meg 21.1Meg 28.7Meg\n.step param F list  3.7Meg 14.1Meg 28.7Meg\n;.param F 28.7Meg\n.param S .009\n.param BM2 2.8\n;.step param BM2 2.2 4 .2\n;.step param R 50 500 50\n.param Z 1\n.param Vgs1 3.6\n.param Vgs2 2.1\n.param Vbe 0.65
TEXT 536 464 Left 2 !.include bs170.lib
TEXT 1336 32 Left 2 ;Need 4.5Vp Output at 100R
TEXT 1576 512 Left 2 !.tran 0 20u 18u
